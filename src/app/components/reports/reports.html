<div class="reports-container">
  <h1>Relatório Financeiro</h1>

  <section class="charts-section">
    <div class="chart-card">
      <h3 class="chart-title">Resumo do Mês Atual</h3>
      <div class="chart-wrapper">
        <canvas id="currentMonthChart"></canvas>
      </div>
      <div class="summary-text">
        <p>
          Entradas (c/ saldo ant.):
          <span>{{ currentMonthIncome | currency : "BRL" }}</span>
        </p>
        <p>
          Saídas do Mês:
          <span>{{ currentMonthExpenses | currency : "BRL" }}</span>
        </p>
        <p
          class="balance"
          [ngClass]="{
            positive: currentMonthBalance >= 0,
            negative: currentMonthBalance < 0
          }"
        >
          Saldo Final:
          <strong>{{ currentMonthBalance | currency : "BRL" }}</strong>
        </p>
      </div>
    </div>

    <div class="chart-card">
      <h3 class="chart-title">Projeção de Despesas Futuras</h3>
      <div class="chart-wrapper">
        <canvas id="futureProjectionsChart"></canvas>
      </div>
      <div class="summary-text">
        <p>Total de Despesas Agendadas:</p>
        <p>
          <strong>{{ futureExpenses | currency : "BRL" }}</strong>
        </p>
      </div>
    </div>
  </section>

  <section class="history-section">
    <h2>Histórico de Transações</h2>

    <div *ngIf="allRecentTransactions.length > 0; else noHistory">
      <div class="transactions-list">
        <div
          *ngFor="let transaction of paginatedTransactions"
          class="transaction-item"
          [ngClass]="transaction.type"
        >
          <div class="transaction-details">
            <span class="transaction-description">{{
              transaction.description
            }}</span>
            <span class="transaction-date">{{
              transaction.date | date : "dd/MM/yyyy"
            }}</span>
          </div>
          <div class="transaction-value">
            {{ transaction.value | currency : "BRL" }}
          </div>
        </div>
      </div>

      <div class="pagination-controls">
        <div class="items-per-page-selector">
          <label for="items-per-page">Itens por pág:</label>
          <select
            id="items-per-page"
            [(ngModel)]="itemsPerPage"
            (change)="onItemsPerPageChange()"
          >
            <option *ngFor="let option of itemsPerPageOptions" [value]="option">
              {{ option }}
            </option>
          </select>
        </div>

        <div class="page-navigation">
          <button
            class="pagination-btn"
            (click)="previousPage()"
            [disabled]="currentPage === 1"
          >
            Anterior
          </button>
          <span>Página {{ currentPage }} de {{ totalPages }}</span>
          <button
            class="pagination-btn"
            (click)="nextPage()"
            [disabled]="currentPage === totalPages"
          >
            Próxima
          </button>
        </div>
      </div>
    </div>

    <ng-template #noHistory>
      <div class="no-transactions">
        <p>Nenhum histórico de transações encontrado.</p>
      </div>
    </ng-template>
  </section>
</div>
