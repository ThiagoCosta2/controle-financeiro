<div class="container" *ngIf="summary$ | async as summary">
  <!-- Cabeçalho da seção -->
  <div class="section-header">
    <h1>Dashboard</h1>
    <div class="actions">
      <button
        class="icon-btn"
        (click)="toggleBalanceVisibility()"
        title="Mostrar/Ocultar valores"
      >
        <svg
          *ngIf="isBalanceVisible"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" />
          <circle cx="12" cy="12" r="3" />
        </svg>
        <svg
          *ngIf="!isBalanceVisible"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M9.88 9.88a3 3 0 1 0 4.24 4.24" />
          <path
            d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"
          />
          <path
            d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"
          />
          <line x1="2" x2="22" y1="2" y2="22" />
        </svg>
      </button>
      <button class="add-btn" (click)="openTransactionModal()">
        + Nova Transação
      </button>
    </div>
  </div>

  <!-- Cards de resumo -->
  <div class="summary-cards">
    <div class="card">
      <h2>Saldo Atual</h2>
      <!-- CORREÇÃO: Aplicando a classe positive/negative diretamente no <p> -->
      <p
        [ngClass]="{
          positive: summary.currentMonthBalance >= 0,
          negative: summary.currentMonthBalance < 0
        }"
      >
        <span [class.hidden]="!isBalanceVisible">{{
          summary.currentMonthBalance | currency : "BRL"
        }}</span>
      </p>
    </div>
    <div class="card">
      <h2>Entradas do Mês</h2>
      <!-- CORREÇÃO: Aplicando a cor verde para entradas -->
      <p class="positive">
        <span [class.hidden]="!isBalanceVisible">{{
          summary.currentMonthIncome | currency : "BRL"
        }}</span>
      </p>
    </div>
    <div class="card">
      <h2>Saídas do Mês</h2>
      <!-- CORREÇÃO: Aplicando a cor vermelha para saídas -->
      <p class="negative">
        <span [class.hidden]="!isBalanceVisible">{{
          summary.currentMonthExpenses | currency : "BRL"
        }}</span>
      </p>
    </div>
  </div>

  <!-- Tabela de Transações Recentes com o novo estilo -->
  <div class="recent-transactions">
    <h2>Transações Recentes</h2>
    <!-- MUDANÇA: Trocamos a <table> por uma <ul> -->
    <ul class="transaction-list">
      <li
        *ngFor="let transaction of summary.recentTransactions"
        class="transaction-item"
        [ngClass]="transaction.type"
      >
        <div class="transaction-details">
          <span class="description">{{ transaction.description }}</span>
          <span class="date">{{ transaction.date | date : "dd/MM/yyyy" }}</span>
        </div>
        <div class="transaction-value">
          <span [class.hidden]="!isBalanceVisible">{{
            transaction.value | currency : "BRL"
          }}</span>
        </div>
      </li>
      <li
        *ngIf="summary.recentTransactions.length === 0"
        class="no-transactions"
      >
        Nenhuma transação registrada este mês.
      </li>
    </ul>
  </div>
</div>

<!-- Modal (Pop-up) para adicionar nova transação -->
<div
  class="modal-overlay"
  *ngIf="showTransactionModal"
  (click)="closeTransactionModal()"
>
  <div class="modal-content" (click)="$event.stopPropagation()">
    <app-transactions
      (transactionSaved)="closeTransactionModal()"
    ></app-transactions>
  </div>
</div>
